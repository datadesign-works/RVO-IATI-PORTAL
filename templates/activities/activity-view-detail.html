<div id="main-content" class="activity">

    <div class="container extra">

        <sub-navbar 
            tabs='vm.tabs' 
            selected-tab='vm.selectedTab'>
        </sub-navbar>

    
        <div class="content-offset" ng-show="vm.selectedTab == 'summary'">
    
            <div class="row">
                <div class="col-md-8">
                    <div class="panel blue no-margin-bottom">
                        <h1 class="no-margin-bottom"><i class="icon presentation"></i>{{vm.activity.titles[0].title}}</h1>
                        <hr>
                        <span class="margin-right-3">Last updated: {{vm.activity.last_updated_datetime | date : 'd MMM yyyy'}}</span><span>Project status: {{vm.activity.activity_status.name}}</span>
                    </div>
                    <div class="featured-image">
                        <img src="{{vm.templateBaseUrl}}/images/Develop2Build header.jpg">
                    </div>
                    <div class="panel white">
                        <h2><i class="icon clock"></i>Summary</h2>
                        <p>{{vm.activity.descriptions[0].description}}</p>              
                    </div>
                    <div class="panel white no-margin-bottom no-padding-bottom">
                        <h2><i class="icon globe"></i>Geographical</h2>
                    </div>
                    <div class="map">
                        <activity-geomap map-height="350px" activity="vm.activity"></activity-geomap>
                    </div>
                    <div class="panel lightblue">
                        <p><b>Region:</b> <a ng-repeat="region in vm.activity.regions" ui-sref="region({ region_id: region.code })">{{region.name}}</a><span ng-if='vm.activity.regions.length == 0'>No data available</span></p>
                        <p><b>Country:</b> <a ng-repeat="country in vm.activity.countries" ui-sref="country({ country_id: country.code })">{{country.name}}</a><span ng-if='vm.activity.countries.length == 0'>No data available</span> </p>
                    </div>
                    <div class="panel white no-margin-bottom no-padding-bottom">
                        <h2><i class="icon euro"></i>Financial</h2>
                    </div>
                    <div class="panel lightblue">
                        <p><b>Finance type:</b> <span ng-if='vm.activity.default_finance_type.name.length'>{{vm.activity.default_finance_type.name}}</span><span ng-if='!vm.activity.default_finance_type.name.length'>No data available</span></p>
                        <p><b>Project budget:</b> <span ng-if='vm.activity.total_budget.length'>{{vm.activity.total_budget | shortcurrency :'€'}}</span><span ng-if='!vm.activity.total_budget.length'>No data available</span></p>
                    </div>
                    <table class="finance">
                        <thead>
                            <tr>
                                <th>Transaction type</th>
                                <th>Value</th>
                                <th>Date</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="transaction in vm.activity.transactions">
                                <td>
                                    {{transaction.transaction_type}}
                                </td>
                                <!-- <td>
                                    {{transaction.provider_organisation_name}}
                                </td>
                                <td>
                                    {{transaction.receiver_organisation_name}}
                                </td> -->
                                <td>
                                    {{transaction.value | openaidcurrency :'€':0:".":"."}}
                                </td>
                                <td>
                                    {{transaction.transaction_date}}
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="graph">
                        <nvd3 options="vm.transactionChartOptions" data="vm.transactionData" class="with-3d-shadow with-transitions"></nvd3>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="panel lightblue">
                        <h3>Information</h3>
                        <hr>
                        <table class="no-format">
                            <tr>
                                <td>IATI Identifier: </td>
                                <td>{{vm.activity.iati_identifier}}</td>
                            </tr>
                            <tr>
                                <td>Start date:</td>
                                <td>{{vm.activity.start_actual.length ? vm.activity.start_actual : 'No data available' | date : 'd MMM yyyy'}}</td>
                            </tr>
                            <tr>
                                <td>End date:</td>
                                <td>{{vm.activity.end_actual.length ? vm.activity.end_actual : 'No data available' | date : 'd MMM yyyy'}}</td>
                            </tr>
                        </table>
                    </div>
                    <div class="panel lightblue share">
                        <h3>Export & share</h3>
                        <hr>
                        <p class="no-margin-bottom">Download the project data</p>
                        <p>
                            <a ng-click="vm.download('json')"><i class="icon download"></i>JSON</a>
                        </p>
                        <p class="no-margin-bottom">Share this project</p>
                        <p class="two-columns">
                            <a target="_blank" ng-href="http://twitter.com/home?status={{vm.shareDescription}}"><i class="icon twitter"></i>Twitter</a>
                            <a target="_blank" ng-href="http://www.facebook.com/sharer/sharer.php?s=100&p[url]={{vm.pageUrl}}"><i class="icon facebook"></i>Facebook</a>
                            <a target="_blank" ng-href="http://www.linkedin.com/shareArticle?mini=true&url={{vm.pageUrl}}&title={{vm.shareDescription}}"><i class="icon linkedin"></i>LinkedIn</a>
                            <a href=""><i class="icon email"></i>Email</a>
                        </p>
                    </div>
                    <div class="panel lightblue">
                        <h3>Sector tags</h3>
                        <hr>
                        <p><a ui-sref="sector({'sector_id': sector.code})" ng-repeat="(key, sector) in vm.activity.sectors">{{ sector.name }}, </a><span ng-show='!vm.activity.sectors.length'>No data available</span></p>
                    </div>
                    <div class="panel lightblue">
                        <h3>Project partners</h3>
                        <hr>
                        <p><b>Reporting organisation:</b> {{vm.activity.reporting_organisation.name}}</p>
                        <p><b>Participating organisations:</b> <span ng-repeat='org in vm.activity.participating_organisations'>{{org.name}}, </span></p>
                    </div>
                    <div class="panel lightblue">
                        <h3>Project updates</h3>
                        <hr>
                        <div class="video">
                            <iframe width="581" height="215" src="https://www.youtube.com/embed/Ygng2822jMQ" frameborder="0" allowfullscreen></iframe>
                        </div>
                        <div class="video">
                            <iframe width="581" height="215" src="https://www.youtube.com/embed/Ygng2822jMQ" frameborder="0" allowfullscreen></iframe>
                        </div>
                        <h4>Related documents</h4>
                        <hr>
                            <p ng-show="vm.activity.documents.length == 0">
                                No documents available.
                            </p>
                            <p ng-repeat="document in vm.activity.documents">
                                <a target="_blank" href="{{document.url}}">
                                    <i class="glyphicon glyphicon-download-alt"></i>{{document.title}}
                                </a>
                            </p>
                    </div>
                    <div class="panel lightblue">
                        <h3>Embed code</h3>
                        <hr>
                        <p>Copy and paste on your site</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- detailed report page -->
        <div class="row" ng-if="vm.selectedTab == 'detailedreport'">
            <div class="col-md-8">

               <div class="panel blue">
                    <h1 class="no-margin-bottom"><i class="icon presentation"></i>{{vm.activity.titles[0].title}}</h1>
                    <hr>
                    <span class="margin-right-3">Last updated: {{vm.activity.last_updated_datetime | date : 'd MMM yyyy'}}</span><span>Project status: {{vm.activity.activity_status.name}}</span>
                </div>

                <div class="panel white no-margin-bottom no-padding-bottom">
                    <h2><i class="icon euro"></i>Full report</h2>
                </div>
                <div class="panel xlightblue no-margin-bottom">
                    <div class="row">
                        <div class="col-sm-4">
                            IATI Identifier
                        </div>
                        <div class="col-sm-8">
                            {{vm.activity.iati_identifier}}
                        </div>
                    </div>
                </div>
                <div class="panel blue no-margin-bottom">
                    Description
                </div>
                <div class="panel xlightblue">
                    <p>{{vm.activity.descriptions[0].description}}</p>
                </div>

                <div class="wrap-alternate">
                    <div class="panel no-margin-bottom">
                        <div class="row">
                            <div class="col-sm-4">
                                Project scope
                            </div>
                            <div class="col-sm-8">
                                <span ng-if='vm.activity.activity_scope.name.length'>{{vm.activity.activity_scope.name}}</span>
                                <span ng-if='!vm.activity.activity_scope.name.length'>No data available</span>
                            </div>
                        </div>
                    </div>
                    <div class="panel no-margin-bottom">
                        <div class="row">
                            <div class="col-sm-4">
                                Start date planned
                            </div>
                            <div class="col-sm-8">
                                {{vm.activity.start_planned.length ? vm.activity.start_planned : 'No data available' | date : 'dd MMM yyyy'}}
                            </div>
                        </div>
                    </div>
                    <div class="panel no-margin-bottom">
                        <div class="row">
                            <div class="col-sm-4">
                                Start date actual
                            </div>
                            <div class="col-sm-8">
                                {{vm.activity.start_actual.length ? vm.activity.start_actual : 'No data available' | date : 'dd MMM yyyy'}}
                            </div>
                        </div>
                    </div>
                    <div class="panel no-margin-bottom">
                        <div class="row">
                            <div class="col-sm-4">
                                End date planned
                            </div>
                            <div class="col-sm-8">
                                {{vm.activity.end_planned.length ? vm.activity.end_planned : 'No data available' | date : 'dd MMM yyyy'}}
                            </div>
                        </div>
                    </div>
                    <div class="panel no-margin-bottom">
                        <div class="row">
                            <div class="col-sm-4">
                                End date actual
                            </div>
                            <div class="col-sm-8">
                                {{vm.activity.end_actual.length ? vm.activity.end_actual : 'No data available' | date : 'dd MMM yyyy'}}
                            </div>
                        </div>
                    </div>
                    <div class="panel no-margin-bottom">
                        <div class="row">
                            <div class="col-sm-4">
                                Reporting organisation
                            </div>
                            <div class="col-sm-8">
                                {{vm.activity.reporting_organisation.name}}
                            </div>
                        </div>
                    </div>
                    <div class="panel no-margin-bottom">
                        <div class="row">
                            <div class="col-sm-4">
                                Participating organisations
                            </div>
                            <div class="col-sm-8">
                                <span ng-repeat='org in vm.activity.participating_organisations'>{{org.name}},</span>
                            </div>
                        </div>
                    </div>
                    <div class="panel no-margin-bottom">
                        <div class="row">
                            <div class="col-sm-4">
                                Country
                            </div>
                            <div class="col-sm-8">
                                <a ng-repeat="country in vm.activity.countries" ui-sref="country({ country_id: country.code })">{{country.name}}</a><span ng-if='vm.activity.countries.length == 0'>No data available</span>
                            </div>
                        </div>
                    </div>
                    <div class="panel no-margin-bottom">
                        <div class="row">
                            <div class="col-sm-4">
                                Region
                            </div>
                            <div class="col-sm-8">
                                <a ng-repeat="region in vm.activity.regions" ui-sref="region({ region_id: region.code })">
                                    {{region.name}}
                                </a>
                                <span ng-if='vm.activity.regions.length == 0'>No data available</span>
                            </div>
                        </div>
                    </div>
                    <div class="panel no-margin-bottom">
                        <div class="row">
                            <div class="col-sm-4">
                                Locations
                            </div>
                            <div class="col-sm-8">
                                <span ng-repeat="location in vm.activity.locations" >
                                    {{location.name}},
                                </span>
                                <span ng-if='vm.activity.locations.length == 0'>No data available</span>
                            </div>
                        </div>
                    </div>
                    <div class="panel no-margin-bottom">
                        <div class="row">
                            <div class="col-sm-4">
                                Sectors
                            </div>
                            <div class="col-sm-8">
                                <a ui-sref="sector({'sector_id': sector.code})" ng-repeat="(key, sector) in vm.activity.sectors">{{ sector.name }}, </a><span ng-show='!vm.activity.sectors.length'>No data available</span>
                            </div>
                        </div>
                    </div>
                    <div class="panel no-margin-bottom">
                        <div class="row">
                            <div class="col-sm-4">
                                Sector code
                            </div>
                            <div class="col-sm-8">
                                <a ui-sref="sector({ sector_id: vm.activity.sectors[0].code })">{{vm.activity.sectors[0].code}}</a>
                            </div>
                        </div>
                    </div>
                    <div class="panel no-margin-bottom">
                        <div class="row">
                            <div class="col-sm-4">
                                Other identifiers
                            </div>
                            <div class="col-sm-8">
                                <a ng-repeat="other_identifier in vm.activity.other_identifier">
                                    {{other_identifier.name}}
                                </a>
                                <span ng-if='vm.activity.related_activities.length == 0'>No data available</span>
                            </div>
                        </div>
                    </div>
                    <div class="panel">
                        <div class="row">
                            <div class="col-sm-4">
                                Related activities
                            </div>
                            <div class="col-sm-8">
                                <a ng-repeat="act in vm.activity.related_activities">
                                    {{act.id}}
                                </a>
                                <span ng-if='vm.activity.related_activities.length == 0'>No data available</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="panel blue no-margin-bottom">
                    Transaction
                </div>
                <div class="wrap-alternate">
                    <div class="panel no-margin-bottom">
                        <div class="row">
                            <div class="col-sm-4">
                                Finance type
                            </div>
                            <div class="col-sm-8">
                                <span ng-if='vm.activity.default_finance_type.name.length'>{{vm.activity.default_finance_type.name}}</span>
                                <span ng-if='!vm.activity.default_finance_type.name.length'>No data available</span>
                            </div>
                        </div>
                    </div>
                    <div class="panel no-margin-bottom">
                        <div class="row">
                            <div class="col-sm-4">
                                Estimated budget
                            </div>
                            <div class="col-sm-8">
                                <span ng-if='vm.activity.total_budget.length'>{{vm.activity.total_budget | shortcurrency :'€'}}</span>
                                <span ng-if='!vm.activity.total_budget.length'>No data available</span>
                            </div>
                        </div>
                    </div>
                    <div class="panel no-margin-bottom">
                        <div class="row">
                            <div class="col-sm-4">
                                Capital spent
                            </div>
                            <div class="col-sm-8">
                                <span ng-if='vm.activity.activity_scope.name.length'>{{vm.activity.capital_spend.percentage}}</span>
                                <span ng-if='!vm.activity.activity_scope.name.length'>No data available</span>
                            </div>
                        </div>
                    </div>
                    <div class="panel no-margin-bottom">
                        <div class="row">
                            <div class="col-sm-4">
                                Flow type
                            </div>
                            <div class="col-sm-8">
                                <span ng-if='vm.activity.default_flow_type.name.length'>{{vm.activity.default_flow_type.name}}</span>
                                <span ng-if='!vm.activity.default_flow_type.name.length'>No data available</span>
                            </div>
                        </div>
                    </div>
                    <div class="panel no-margin-bottom">
                        <div class="row">
                            <div class="col-sm-4">
                                Tied status
                            </div>
                            <div class="col-sm-8">
                                <span ng-if='vm.activity.default_tied_status.name.length'>{{vm.activity.default_tied_status.name}}</span>
                                <span ng-if='!vm.activity.default_tied_status.name.length'>No data available</span>
                            </div>
                        </div>
                    </div>
                    <div class="panel no-margin-bottom">
                        <div class="row">
                            <div class="col-sm-4">
                                Collaboration type
                            </div>
                            <div class="col-sm-8">
                                <span ng-if='vm.activity.collaboration_type.name.length'>{{vm.activity.collaboration_type.name}}</span>
                                <span ng-if='!vm.activity.collaboration_type.name.length'>No data available</span>
                            </div>
                        </div>
                    </div>
                    <div class="panel no-margin-bottom">
                        <div class="row">
                            <div class="col-sm-4">
                                Aid type
                            </div>
                            <div class="col-sm-8">
                                <span ng-if='vm.activity.default_aid_type.name.length'>{{vm.activity.default_aid_type.name}}</span>
                                <span ng-if='!vm.activity.default_aid_type.name.length'>No data available</span>
                            </div>
                        </div>
                    </div>
                    <div class="panel no-margin-bottom">
                        <div class="row">
                            <div class="col-sm-4">
                                Websites
                            </div>
                            <div class="col-sm-8">
                                <a ng-repeat="website in vm.activity.websites">
                                    {{website.name}}
                                </a>
                                <span ng-if='vm.activity.websites.length == 0'>No data available</span>
                            </div>
                        </div>
                    </div>
                    <div class="panel no-margin-bottom">
                        <div class="row">
                            <div class="col-sm-4">
                                Linked data URI
                            </div>
                            <div class="col-sm-8">
                                <span ng-if='vm.activity.linked_data_uri.length'>{{vm.activity.linked_data_uri}}</span>
                                <span ng-if='!vm.activity.linked_data_uri.length'>No data available</span>
                            </div>
                        </div>
                    </div>
                    <div class="panel no-margin-bottom">
                        <div class="row">
                            <div class="col-sm-4">
                                Hierarchy
                            </div>
                            <div class="col-sm-8">
                                <span ng-if='vm.activity.hierarchy'>{{vm.activity.hierarchy}}</span>
                                <span ng-if='!vm.activity.hierarchy'>No data available</span>
                            </div>
                        </div>
                    </div>
                    <div class="panel no-margin-bottom">
                        <div class="row">
                            <div class="col-sm-4">
                                Results
                            </div>
                            <div class="col-sm-8">
                                <a ng-repeat="result in vm.activity.results">
                                    {{result.name}}
                                </a>
                                <span ng-if='vm.activity.results.length == 0'>No data available</span>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
            <div class="col-md-4">
                <div class="panel lightblue share">
                    <h3>Export & share</h3>
                    <hr>
                    <p class="no-margin-bottom">Download the project data</p>
                    <p>
                        <a ng-click="vm.download('json')"><i class="icon download"></i>JSON</a>
                    </p>
                    <p class="no-margin-bottom">Share this project</p>
                    <p class="two-columns">
                        <a target="_blank" ng-href="http://twitter.com/home?status={{vm.shareDescription}}"><i class="icon twitter"></i>Twitter</a>
                        <a target="_blank" ng-href="http://www.facebook.com/sharer/sharer.php?s=100&p[url]={{vm.pageUrl}}"><i class="icon facebook"></i>Facebook</a>
                        <a target="_blank" ng-href="http://www.linkedin.com/shareArticle?mini=true&url={{vm.pageUrl}}&title={{vm.shareDescription}}"><i class="icon linkedin"></i>LinkedIn</a>
                        <a href=""><i class="icon email"></i>Email</a>
                    </p>
                </div>
            </div>
        </div>

    </div>
</div>


